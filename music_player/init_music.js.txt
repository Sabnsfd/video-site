// music_player/init_music.js

(function() { // Używamy IIFE (Immediately Invoked Function Expression), aby nie zaśmiecać globalnego zakresu
    // --- KONFIGURACJA ---
    // Ścieżka do Twojego pliku muzycznego.
    // Upewnij się, że jest poprawna względem miejsca, gdzie znajduje się plik HTML.
    // Jeśli plik HTML jest w głównym katalogu, a muzyka w 'music_player/', to ścieżka będzie 'music_player/background_music.mp3'.
    const musicFilePath = 'music_player/background_music.mp3'; 
    
    const audioId = 'background-music-player'; // ID dla elementu audio
    const showControls = true; // true = pokaż kontrolki odtwarzacza (play/pause, głośność), false = ukryj
    const autoPlayAttempt = true; // true = spróbuj automatycznie odtworzyć muzykę

    // Sprawdź, czy odtwarzacz audio już istnieje, aby uniknąć duplikacji
    if (document.getElementById(audioId)) {
        console.log("Odtwarzacz muzyki w tle już istnieje na tej stronie.");
        return;
    }

    // Utwórz element audio
    const audio = document.createElement('audio');
    audio.id = audioId;
    audio.loop = true; // Zapętlenie muzyki

    if (showControls) {
        audio.controls = true; // Pokaż kontrolki odtwarzacza
    } else {
        audio.style.display = 'none'; // Ukryj odtwarzacz, jeśli nie chcesz kontrolek
    }

    // Utwórz element source dla pliku muzycznego
    const source = document.createElement('source');
    source.src = musicFilePath;
    source.type = 'audio/mpeg'; // Zmień na 'audio/ogg' lub inny, jeśli Twój plik ma inny format

    // Dodaj source do audio
    audio.appendChild(source);

    // Dodaj tekst awaryjny dla przeglądarek, które nie obsługują elementu audio
    audio.textContent = 'Twoja przeglądarka nie obsługuje elementu audio.';

    // Dodaj element audio do ciała dokumentu (body)
    // Możesz go ukryć za pomocą CSS, jeśli nie chcesz, aby był widoczny
    document.body.appendChild(audio);

    // Próba odtworzenia muzyki, jeśli autoPlayAttempt jest ustawione na true
    if (autoPlayAttempt) {
        audio.play().then(() => {
            console.log("Muzyka w tle została pomyślnie uruchomiona.");
        }).catch(error => {
            console.warn("Automatyczne odtwarzanie zostało zablokowane lub wystąpił błąd:", error);
            // Jeśli autoplay się nie powiedzie, a kontrolki są ukryte, możesz poinformować użytkownika
            if (!showControls) {
                console.log("Odtwarzacz muzyki jest ukryty. Użytkownik musi wejść w interakcję ze stroną, aby odtworzyć muzykę.");
                // Opcjonalnie, możesz tutaj sprawić, że kontrolki staną się widoczne, jeśli autoplay zawiedzie
                // audio.controls = true;
                // audio.style.display = 'block';
            }
        });
    }
})();
